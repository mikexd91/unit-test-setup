pipeline {
	agent any

	stages {

		stage ("Setup NodeJS") {
			steps {
				nodejs(configId: '08136756-fa8c-4f4c-9bb1-516707682c34', nodeJSInstallationName: 'Node v6.10.3 - install automatically') {
				    sh 'node --version';
				}
			}
		}
		
		stage ("install") {
			steps {
				sh 'npm install';
			}
		}

		stage ("Tests") {
			steps {
				parallel (

					eslint: {
						try {
							sh 'npm run eslint';
						} catch (err) {
							echo err;
						} finally {
							checkstyle canComputeNew: false, defaultEncoding: '', healthy: '', pattern: 'app/test/reports/eslint/checkstyle/eslint-report.xml', unHealthy: '';
						}
					},

					karma: {
						try {
							sh 'npm run eslint';
						} catch (err) {
							echo err;
						} finally {
							junit 'app/test/reports/**/*.xml';
						}
					}

				)
			}
		}

		stage ("report") {
			steps {
				echo "report";
			}
		}



	}
}